
<script type="text/javascript">
	RED.nodes.registerType('msgtimeout',{
		category: 'function',
		color:"#E8E8F8",
		defaults: {
			onmsgtimeouttype: {value:'str'},
			onmsgtimeoutval: {value:""},
			duration: {value:"5",required:true,validate:RED.validators.number()},
			units: {value:"s"},
			name: {value:""}
		},
		inputs:1,
		outputs:2,
		icon: "trigger.png",
		paletteLabel: 'msg timeout',
		label: function() {
			return this.name + " " + this.duration + this.units || "msgtimeout" + " " + this.duration + this.units;
		},
		labelStyle: function() {
			return this.name?"node_label_italic":"";
		},
		oneditprepare: function() {
			$("#node-input-onmsgtimeoutval").typedInput({
				default: 'str',
				typeField: $("#node-input-onmsgtimeouttype"),
				types:['json','str','num','bool','flow','global']
			});
		}
	});
</script>

<script type="text/x-red" data-template-name="msgtimeout">
	<div class="form-row">
		<label><i class="fa fa-clock-o"></i> Time-Out</label>
		<input type="text" id="node-input-duration" style="text-align:end; width:70px !important">
		<select id="node-input-units" style="width:140px !important">
			<option value="ms">Miliseconds</option>
			<option value="s">Seconds</option>
			<option value="min">Minutes</option>
			<option value="hr">Hours</option>
		</select>
	</div>
	<div class="form-row">
		<label for="node-input-onmsgtimeouttype"><i class="fa fa-feed"></i> Send on Input Message Time-Out</label>
		<input type="hidden" id="node-input-onmsgtimeouttype">
		<input style="width: 70%" type="text" id="node-input-onmsgtimeoutval">
	</div>
	<div class="form-row">
		<label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
		<input type="text" id="node-input-name" placeholder="Name"></input>
	</div>
</script>

<script type="text/x-red" data-help-name="msgtimeout">
	<p>All input is sent to the first output <code>msg</code></p>
	<p>A timeout is created when no input msg has been received (by the defined period)</p>
	<p>A new <code>msg</code> is created(sent) with the user defined data to the second output only.</br>
         </p>
</script>

